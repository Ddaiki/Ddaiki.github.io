<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¿ãƒã‚³å°å£²å®šä¾¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Daiki Hasegawa</title>
  <meta name="description" content="è²¡å‹™çœç™ºè¡¨ã®ãŸã°ã“å°å£²å®šä¾¡ã‚’è¨˜éŒ²ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‚éŠ˜æŸ„åãƒ»åŒºåˆ†ãƒ»å®šä¾¡ã®å¤‰é·ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Hiragino Sans', 'Meiryo', sans-serif; background: #fafaf8; color: #2c2c2c; }

    header { background: #2c2c2c; color: #fff; padding: 40px 20px; text-align: center; }
    header h1 { font-size: 1.5rem; margin-bottom: 8px; }
    header p { font-size: 0.9rem; opacity: 0.7; }
    header a { color: #ccc; font-size: 0.85rem; text-decoration: none; }
    header a:hover { text-decoration: underline; }

    .search-bar {
      max-width: 1100px;
      margin: 30px auto 10px;
      padding: 0 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .search-bar input {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      min-width: 200px;
    }

    .search-bar select {
      padding: 10px 14px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }

    .search-bar button {
      padding: 10px 20px;
      background: #2c2c2c;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }

    .info {
      max-width: 1100px;
      margin: 0 auto 10px;
      padding: 0 20px;
      font-size: 0.85rem;
      color: #666;
    }

    .table-wrap {
      max-width: 1100px;
      margin: 0 auto 60px;
      padding: 0 20px;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      font-size: 0.85rem;
    }

    th {
      background: #2c2c2c;
      color: #fff;
      padding: 10px 12px;
      text-align: left;
      white-space: nowrap;
    }

    td {
      padding: 9px 12px;
      border-bottom: 1px solid #eee;
      vertical-align: top;
    }

    tr:hover td { background: #f5f5f3; }

    .price-current { font-weight: bold; color: #c0392b; }
    .price-old { color: #888; font-size: 0.8rem; }
    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.75rem;
      background: #eee;
    }
    .badge.henkou { background: #fdecea; color: #c0392b; }
    .badge.ninka { background: #e8f5e9; color: #2e7d32; }
    .badge.haiban { background: #333; color: #fff; }

    .loading { text-align: center; padding: 60px; color: #999; }
    .no-result { text-align: center; padding: 40px; color: #999; }

    footer { text-align: center; padding: 40px; font-size: 0.85rem; color: #999; border-top: 1px solid #ddd; }
  </style>
</head>
<body>

<header>
  <p><a href="/">â† ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a></p>
  <h1>ğŸš¬ ã‚¿ãƒã‚³å°å£²å®šä¾¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h1>
  <p>è²¡å‹™çœç™ºè¡¨ã®å°å£²å®šä¾¡ã‚’è¨˜éŒ²ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆå‡ºå…¸ï¼š<a href="https://www.mof.go.jp/policy/tab_salt/topics/kouriteika.html" target="_blank">è²¡å‹™çœ</a>ï¼‰</p>
</header>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="éŠ˜æŸ„åã§æ¤œç´¢...">
  <select id="filterKubun">
    <option value="">ã™ã¹ã¦ã®åŒºåˆ†</option>
    <option value="åŠ ç†±å¼ãŸã°ã“">åŠ ç†±å¼ãŸã°ã“</option>
    <option value="ç´™å·»ãŸã°ã“">ç´™å·»ãŸã°ã“</option>
    <option value="è‘‰å·»ãŸã°ã“">è‘‰å·»ãŸã°ã“</option>
    <option value="ãƒ‘ã‚¤ãƒ—ãŸã°ã“">ãƒ‘ã‚¤ãƒ—ãŸã°ã“</option>
    <option value="å™›ã¿ãŸã°ã“">å™›ã¿ãŸã°ã“</option>
    <option value="å—…ããŸã°ã“">å—…ããŸã°ã“</option>
  </select>
  <button onclick="filterTable()">æ¤œç´¢</button>
  <button onclick="clearSearch()" style="background:#888;">ã‚¯ãƒªã‚¢</button>
</div>

<div class="info" id="info">èª­ã¿è¾¼ã¿ä¸­...</div>

<div class="table-wrap">
  <table id="dataTable">
    <thead>
      <tr>
        <th>åŒºåˆ†</th>
        <th>éŠ˜æŸ„å</th>
        <th>è£½å“ã®åŒºåˆ†</th>
        <th>è£½é€ å›½</th>
        <th>ç¾åœ¨ã®å®šä¾¡</th>
        <th>æœ€æ–°å¤‰æ›´æ—¥</th>
        <th>èªå¯ç¨®åˆ¥</th>
        <th>å»ƒç›¤</th>
        <th>å®šä¾¡ã®å¤‰é·</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <tr><td colspan="9" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</td></tr>
    </tbody>
  </table>
</div>

<footer>
  <p>å‡ºå…¸ï¼šè²¡å‹™çœã€Œè£½é€ ãŸã°ã“ã®å°å£²å®šä¾¡èªå¯ã€/ Â© 2025 Daiki Hasegawa</p>
</footer>

<script>
  const SHEET_ID = '1-BOwLrGymu6BpQiC9tKrlqhEoEZaqsWP9Kqz9iP_sgI';
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

  let allRows = [];

  fetch(url)
    .then(r => r.text())
    .then(text => {
      const json = JSON.parse(text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\)/)[1]);
      const rows = json.table.rows;
      allRows = rows.slice(1).map(row => row.c.map(cell => cell ? String(cell.v || '') : ''));
      renderTable(allRows);
      document.getElementById('info').textContent = `å…¨ ${allRows.length} ä»¶`;
    })
    .catch(() => {
      document.getElementById('tableBody').innerHTML = '<tr><td colspan="9" class="no-result">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</td></tr>';
      document.getElementById('info').textContent = '';
    });

  function buildHistory(row) {
    // åˆ—I(8)ä»¥é™ãŒéå»å®šä¾¡ãƒ»æ—¥ä»˜ã®ãƒšã‚¢
    let html = '';
    for (let i = 8; i < row.length - 1; i += 2) {
      if (row[i]) {
        html += `<span class="price-old">${row[i+1] ? row[i+1] + 'ï¼š' : ''}${row[i]}å††</span><br>`;
      }
    }
    return html || 'â€”';
  }

  function renderTable(rows) {
    const tbody = document.getElementById('tableBody');
    if (rows.length === 0) {
      tbody.innerHTML = '<tr><td colspan="9" class="no-result">è©²å½“ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
      return;
    }
    tbody.innerHTML = rows.map(c => {
      const ninkaBadge = c[6] === 'å¤‰æ›´èªå¯'
        ? '<span class="badge henkou">å¤‰æ›´èªå¯</span>'
        : '<span class="badge ninka">èªå¯</span>';
      const haibanBadge = c[7] ? '<span class="badge haiban">å»ƒç›¤</span>' : '';
      return `
        <tr>
          <td>${c[0]||''}</td>
          <td>${c[1]||''}</td>
          <td>${c[2]||''}</td>
          <td>${c[3]||''}</td>
          <td class="price-current">${c[4] ? c[4]+'å††' : 'â€”'}</td>
          <td>${c[5]||'â€”'}</td>
          <td>${ninkaBadge}</td>
          <td>${haibanBadge}</td>
          <td>${buildHistory(c)}</td>
        </tr>
      `;
    }).join('');
    document.getElementById('info').textContent = `${rows.length} ä»¶è¡¨ç¤ºä¸­`;
  }

  function filterTable() {
    const q = document.getElementById('searchInput').value.toLowerCase();
    const kubun = document.getElementById('filterKubun').value;
    const filtered = allRows.filter(row => {
      const matchQ = !q || row.some(cell => cell.toLowerCase().includes(q));
      const matchK = !kubun || row[0].includes(kubun);
      return matchQ && matchK;
    });
    renderTable(filtered);
  }

  function clearSearch() {
    document.getElementById('searchInput').value = '';
    document.getElementById('filterKubun').value = '';
    renderTable(allRows);
  }

  document.getElementById('searchInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') filterTable();
  });
</script>

</body>
</html>
